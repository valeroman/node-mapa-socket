(this["webpackJsonpmaps-app"]=this["webpackJsonpmaps-app"]||[]).push([[0],{50:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n(43),r=n.n(o),a=(n(50),n(13)),u=n(14),i=n.n(u),s=n(89),f=n(88),l=n(44);n.n(l).a.config(),i.a.accessToken="pk.eyJ1IjoidmFsZXJvbWFuIiwiYSI6ImNraHoxNGx2dzBjZzgyd29oanl6aW9rN3kifQ.kBtunHmUn4AoM5-5g01zhQ";var b=n(45),d=n.n(b),j=n(1),m=Object(c.createContext)(),O=function(e){var t=e.children,n=function(e){var t=Object(c.useMemo)((function(){return d.a.connect(e,{transports:["websocket"]})}),[e]),n=Object(c.useState)(!1),o=Object(a.a)(n,2),r=o[0],u=o[1];return Object(c.useEffect)((function(){u(t.connected)}),[t]),Object(c.useEffect)((function(){t.on("connect",(function(){return u(!0)}))}),[t]),Object(c.useEffect)((function(){t.on("disconnect",(function(){return u(!1)}))}),[t]),{socket:t,online:r}}("https://mapa-rv.herokuapp.com/"),o=n.socket,r=n.online;return Object(j.jsx)(m.Provider,{value:{socket:o,online:r},children:t})},v={lng:-79.537,lat:8.9318,zoom:13},g=function(){var e=function(e){var t=Object(c.useRef)(),n=Object(c.useCallback)((function(e){t.current=e}),[]),o=Object(c.useRef)({}),r=Object(c.useRef)(new f.a),u=Object(c.useRef)(new f.a),l=Object(c.useRef)(),b=Object(c.useState)(e),d=Object(a.a)(b,2),j=d[0],m=d[1],O=Object(c.useCallback)((function(e,t){var n=e.lngLat||e,c=n.lng,a=n.lat,f=new i.a.Marker;f.id=null!==t&&void 0!==t?t:Object(s.a)(),f.setLngLat([c,a]).addTo(l.current).setDraggable(!0),o.current[f.id]=f,t||u.current.next({id:f.id,lng:c,lat:a}),f.on("drag",(function(e){var t=e.target,n=t.id,c=t.getLngLat(),o=c.lng,a=c.lat;r.current.next({id:n,lng:o,lat:a})}))}),[]),v=Object(c.useCallback)((function(e){var t=e.id,n=e.lng,c=e.lat;o.current[t].setLngLat([n,c])}),[]);return Object(c.useEffect)((function(){var n=new i.a.Map({container:t.current,style:"mapbox://styles/mapbox/streets-v11",center:[e.lng,e.lat],zoom:e.zoom});l.current=n}),[e]),Object(c.useEffect)((function(){var e;null===(e=l.current)||void 0===e||e.on("move",(function(){var e=l.current.getCenter(),t=e.lng,n=e.lat;m({lng:t.toFixed(4),lat:n.toFixed(4),zoom:l.current.getZoom().toFixed(2)})}))}),[]),Object(c.useEffect)((function(){var e;null===(e=l.current)||void 0===e||e.on("click",O)}),[O]),{actualizarPosicion:v,agregarMarcador:O,coords:j,marcadores:o,movimientoMarcador$:r.current,nuevoMarcador$:u.current,setRef:n}}(v),t=e.coords,n=e.setRef;return function(e,t,n,o,r){var a=Object(c.useContext)(m).socket;Object(c.useEffect)((function(){a.on("marcadores-activos",(function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var c=n[t];o(e[c],c)}}))}),[a,o]),Object(c.useEffect)((function(){t.subscribe((function(e){a.emit("marcador-nuevo",e)}))}),[t,a]),Object(c.useEffect)((function(){n.subscribe((function(e){a.emit("marcador-actualizado",e)}))}),[a,n]),Object(c.useEffect)((function(){a.on("marcador-actualizado",(function(e){r(e)}))}),[a,r]),Object(c.useEffect)((function(){a.on("marcador-nuevo",(function(e){o(e,e.id)}))}),[a,o])}(0,e.nuevoMarcador$,e.movimientoMarcador$,e.agregarMarcador,e.actualizarPosicion),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"info",children:["Lng: ",t.lng," | Lat: ",t.lat," | Zoom: ",t.zoom]}),Object(j.jsx)("div",{ref:n,className:"mapContainer"})]})},p=function(){return Object(j.jsx)(O,{children:Object(j.jsx)(g,{})})};r.a.render(Object(j.jsx)(p,{}),document.getElementById("root"))}},[[85,1,2]]]);
//# sourceMappingURL=main.9f6aec0b.chunk.js.map